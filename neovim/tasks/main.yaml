---
# https://github.com/Microsoft/WSL/issues/3286'
- name: apt add neovim repository
  become: yes
  apt_repository:
    repo: "{{ item }}"
  with_items:
    - "{{ neovim.apt.repositories }}"
- name: apt install neovim
  become: yes
  apt:
    name: "{{ neovim.apt.packages }}"
    state: latest
- name: install pip3 packages for neovim
  pip:
    name: "{{ neovim.pip.packages }}"
    executable: pip3
    extra_args: --user
    state: latest
- name: mkdir ~/.cache/dein/repos/github.com/Shougo
  file:
    path: "{{ neovim.dirs.dein }}"
    state: directory
- name: git clone dein
  git:
    repo: https://github.com/Shougo/dein.vim.git
    dest: "{{ neovim.dirs.dein }}"
    depth: 1
- name: mkdir ~/.config
  file:
    path: "{{ neovim.dirs.config.base }}"
    state: directory
- name: create symlink of nvim configs
  file:
    src: "{{ neovim.dirs.config.src }}"
    dest: "{{ neovim.dirs.config.dest }}"
    state: link
- name: install nvim plugins
  shell: nvim -c ":silent! call dein#install() | :q"
